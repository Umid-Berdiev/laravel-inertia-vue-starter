import{_ as A,a as g,r as V,u as I,o as j,M as x,b as m,d as c,f as o,g as k,e,t as n,w as N,h as t,y as B,G as S,W as R,F as L,j as U,X as z,i as O,p as D,l as Y}from"./app.35649df7.js";import{b as G,w as W}from"./vue-dataset.es.111b1943.js";import{u as X}from"./useNotyf.f631be2c.js";import{_ as y}from"./Input.6c8b1c5c.js";import"./moment.62d3fb0a.js";import{_ as H}from"./BaseBlock.afe43d44.js";import{_ as v}from"./InputLabel.2dd648e5.js";import{C as J}from"./ConfirmModal.7ba8cd55.js";import{_ as h}from"./InputError.cb4920f2.js";import{_ as K}from"./SubmitButton.vue_vue_type_script_setup_true_lang.f325b795.js";const u=r=>(D("data-v-dc73c5c6"),r=r(),Y(),r),P={class:"content"},Q=u(()=>e("div",{class:"d-flex justify-content-end"},[e("button",{type:"button",class:"btn btn-alt-primary push","data-bs-toggle":"modal","data-bs-target":"#userFormModal"},[e("i",{class:"si si-plus me-1"}),e("span",null,"Yangi foydalanuvchi qo'shish")])],-1)),T={key:0,class:"text-center"},Z={class:"row"},ee={class:"col-md-12"},se={class:"table-responsive"},ae={class:"table table-striped mb-0"},te=u(()=>e("th",{scope:"col"},"#",-1)),le={scope:"row"},oe={class:"d-flex gap-2"},ie=["onClick"],ne=u(()=>e("i",{class:"si si-pencil"},null,-1)),de=[ne],re={class:"modal fade",id:"userFormModal",tabindex:"-1","aria-labelledby":"userFormModalLabel","aria-hidden":"true"},me={class:"modal-dialog"},ce={class:"modal-content"},ue={class:"modal-header"},_e={class:"modal-title",id:"userFormModalLabel"},fe=u(()=>e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1)),ve={class:"modal-body"},he=["onSubmit"],pe={class:"row"},be={class:"col-12 mb-3"},ye={class:"col-12 mb-3"},ge={class:"col-12 mb-3"},ke={key:0,class:"col-12 mb-3"},Fe={class:"col-12 mb-3"},Me=["disabled"],Ve=u(()=>e("option",{selected:"",disabled:"",value:null}," Rol tanlang ",-1)),xe=["value"],Se={class:"col-12 mb-3"},Le={class:"form-check form-switch"},Ue=u(()=>e("label",{class:"form-check-label",for:"user_status"},"Faolmi?",-1)),Ce={class:"col-auto ms-auto"},Ee={__name:"Users",props:{users:{type:Array,default:()=>[]},roles:{type:Array,default:()=>[]}},setup(r){const C=r,_=X(),p=g(null),E=V([{name:"Ismi",field:"first_name"},{name:"Familiyasi",field:"last_name"},{name:"Foydalanuvchi nomi (Login)",field:"username"},{name:"Elektron manzili",field:"email"},{name:"Roli",field:"roles"},{name:"Faollik statusi",field:"is_active"}]),b=V({username:"",first_name:"",last_name:"",email:"",role_id:null,is_active:null}),s=I({username:"",first_name:"",last_name:"",email:"",role_id:null,is_active:null}),f=g(!1),F=g(!1);j(()=>{p.value=new x("#userFormModal"),p.value._element.addEventListener("hidden.bs.modal",()=>{f.value=!1,s.reset()}),document.querySelectorAll("#datasetLength label").forEach(a=>{a.remove()});let i=document.querySelector("#datasetLength select");i&&(i.classList="",i.classList.add("form-select"))});async function q(){F.value=!0;try{f.value?s.put(route("users.update",b.id),{onSuccess:()=>{var i;_.success("Ma'lumotlar muvaffaqiyatli saqlandi!"),s.reset(),(i=p.value)==null||i.hide()}}):s.post(route("users.store"),{onSuccess:()=>{var i;_.success("Ma'lumotlar muvaffaqiyatli saqlandi!"),s.reset(),(i=p.value)==null||i.hide()}})}catch{_.error("Ma'lumotlarni saqlashda hatolik!")}finally{F.value=!1}}function w(i){f.value=!0;const a=C.users.find(l=>l.id===i);Object.assign(b,a),s.role_id=b.role_id=a.roles[0].id,s.first_name=a.first_name,s.last_name=a.last_name,s.username=a.username,s.email=a.email,s.is_active=a.is_active}function $(){const i=x.getInstance("#modal-confirm");roleForm.delete(route("users.destroy",b.id),{onSuccess:()=>{_.success("User successfully removed!")},onError:a=>{_.error("Error while deleting user!")}}),i.hide()}return(i,a)=>(m(),c("div",P,[Q,o(H,{title:"Foydalanuvchilar jadvali","content-full":""},{default:k(()=>{var l;return[((l=r.users)==null?void 0:l.length)==0?(m(),c("div",T,n(i.$t("No_data")),1)):(m(),O(t(W),{key:1,"ds-data":r.users},{default:k(()=>[e("div",Z,[e("div",ee,[e("div",se,[e("table",ae,[e("thead",null,[e("tr",null,[te,(m(!0),c(L,null,U(E,(d,M)=>(m(),c("th",{key:d.field},n(d.name),1))),128)),e("th",null,n(i.$t("Actions")),1)])]),o(t(G),{tag:"tbody",class:"fs-sm"},{default:k(({row:d,rowIndex:M})=>[e("tr",null,[e("th",le,n(M+1),1),e("td",null,n(d.first_name),1),e("td",null,n(d.last_name),1),e("td",null,n(d.username),1),e("td",null,n(d.email),1),e("td",null,n(d.roles[0].name),1),e("td",null,n(d.is_active?"Aktiv":"Aktiv emas"),1),e("td",oe,[e("button",{type:"button",class:"btn btn-secondary w-auto","data-bs-toggle":"modal","data-bs-target":"#userFormModal",onClick:qe=>w(d.id)},de,8,ie)])])]),_:1})])])])])]),_:1},8,["ds-data"]))]}),_:1}),e("div",re,[e("div",me,[e("div",ce,[e("div",ue,[e("h5",_e,n(f.value?"Foydalanuvchi ma'lumotlarini o'zgartirish":"Yangi foydalanuvchi ma'lumotlarini yaratish"),1),fe]),e("div",ve,[e("form",{onSubmit:N(q,["prevent"])},[e("div",pe,[e("div",be,[o(v,{value:"Foydalanuvchi nomi (login)",for:"username"}),o(y,{id:"username",type:"text",modelValue:t(s).username,"onUpdate:modelValue":a[0]||(a[0]=l=>t(s).username=l)},null,8,["modelValue"]),o(h,{message:t(s).errors.username},null,8,["message"])]),e("div",ye,[o(v,{value:"Ismi",for:"first_name"}),o(y,{id:"first_name",type:"text",modelValue:t(s).first_name,"onUpdate:modelValue":a[1]||(a[1]=l=>t(s).first_name=l)},null,8,["modelValue"]),o(h,{message:t(s).errors.first_name},null,8,["message"])]),e("div",ge,[o(v,{value:"Familiyasi",for:"last_name"}),o(y,{id:"last_name",type:"text",modelValue:t(s).last_name,"onUpdate:modelValue":a[2]||(a[2]=l=>t(s).last_name=l)},null,8,["modelValue"]),o(h,{message:t(s).errors.last_name},null,8,["message"])]),f.value?B("",!0):(m(),c("div",ke,[o(v,{value:"Elektron manzili",for:"email"}),o(y,{id:"email",type:"text",modelValue:t(s).email,"onUpdate:modelValue":a[3]||(a[3]=l=>t(s).email=l)},null,8,["modelValue"]),o(h,{message:t(s).errors.email},null,8,["message"])])),e("div",Fe,[o(v,{value:"Roli",for:"user_role"}),S(e("select",{id:"user_role",class:"form-select","aria-label":"Role select",disabled:t(s).role_id===1,"onUpdate:modelValue":a[4]||(a[4]=l=>t(s).role_id=l)},[Ve,(m(!0),c(L,null,U(r.roles,l=>(m(),c("option",{value:l.id},n(l.name),9,xe))),256))],8,Me),[[R,t(s).role_id]]),o(h,{message:t(s).errors.role_id},null,8,["message"])]),e("div",Se,[e("div",Le,[S(e("input",{"onUpdate:modelValue":a[5]||(a[5]=l=>t(s).is_active=l),class:"form-check-input",type:"checkbox",id:"user_status",checked:""},null,512),[[z,t(s).is_active]]),Ue])]),e("div",Ce,[o(K,{loading:t(s).processing},null,8,["loading"])])])],40,he)])])])]),o(J,{onConfirm:$})]))}},De=A(Ee,[["__scopeId","data-v-dc73c5c6"]]);export{De as default};
