import{d as q,r as m,a as E,u as j,o as z,M as F,b as c,c as u,e as o,w as h,t as l,f as N,g as e,F as B,h as I,i as t,j as Y}from"./app.56cb7126.js";import{b as D,w as O}from"./vue-dataset.es.b193e4bb.js";import{u as R}from"./useNotyf.9adfdd7d.js";import{_ as U}from"./Input.7aced2d7.js";import{_ as G}from"./BaseBlock.22552c46.js";import{_ as M}from"./InputLabel.5b59311f.js";import{C as H}from"./ConfirmModal.5c5d956d.js";import{_ as k}from"./InputError.fee64527.js";import{_ as J}from"./SubmitButton.vue_vue_type_script_setup_true_lang.371fd828.js";import{C as K}from"./vue-select.es.d3536078.js";const P={class:"content"},Q=e("div",{class:"d-flex justify-content-end"},[e("button",{type:"button",class:"btn btn-sm btn-alt-primary push","data-bs-toggle":"modal","data-bs-target":"#accelerogramFormModal"},[e("i",{class:"si si-plus me-1"}),e("span",null,"Yangi ma'lumot qo'shish")])],-1),T={key:0,class:"text-center"},W={class:"row"},X={class:"col-md-12"},Z={class:"table-responsive"},ee={class:"table table-sm table-striped mb-0"},se=e("th",{scope:"col"},"#",-1),ae={class:"text-center text-capitalize"},oe={class:""},te={scope:"row"},le={class:"d-flex gap-2 justify-content-center"},ne=["onClick"],ie=e("i",{class:"si si-trash"},null,-1),re=[ie],ce={class:"modal fade",id:"accelerogramFormModal",tabindex:"-1","aria-labelledby":"userFormModalLabel","aria-hidden":"true"},de={class:"modal-dialog"},me={class:"modal-content"},ue={class:"modal-header"},_e={class:"modal-title",id:"userFormModalLabel"},fe=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),he={class:"modal-body"},ge=["onSubmit"],pe={class:"row"},be={class:"col-12 mb-3"},ve={class:"col-12 mb-3"},ye={class:"col-auto ms-auto"},qe=q({__name:"Accelerogram",props:{list:{default:()=>[]},regions:{default:()=>[]}},setup(_){const C=_,d=R(),f=m(null),L=E([{name:"Fayil nomi",field:"file_name"},{name:"Viloyat nomi",field:"region_name"}]),g=m(null),a=j({region_soato:"",excel_file:null}),p=m(!1),b=m(!1);z(()=>{f.value=new F("#accelerogramFormModal"),f.value._element.addEventListener("hidden.bs.modal",()=>{p.value=!1,a.reset()}),document.querySelectorAll("#datasetLength label").forEach(r=>{r.remove()});let s=document.querySelector("#datasetLength select");s&&(s.classList="",s.classList.add("form-select"))});async function A(){b.value=!0;try{a.clearErrors(),a.post(route("accelerograms.import"),{onSuccess:()=>{var s;d.success("Ma'lumotlar muvaffaqiyatli saqlandi!"),a.reset(),(s=f.value)==null||s.hide()}})}catch{d.error("Ma'lumotlarni saqlashda hatolik!")}finally{b.value=!1}}function w(s){g.value=s}function S(){const s=F.getInstance("#modal-confirm");roleForm.delete(route("accelerograms.destroy",g.value),{onSuccess:()=>{d.success("Accelerogram successfully removed!")},onError:r=>{d.error("Error while deleting user!")}}),s.hide()}function V(s){a.excel_file=s.target.files[0]}return(s,r)=>{var v,y;return c(),u("div",P,[Q,o(G,{title:"Akselerogrammalar jadvali","content-full":""},{default:h(()=>{var n;return[((n=C.list)==null?void 0:n.length)==0?(c(),u("div",T,l(s.$t("No_data")),1)):(c(),N(t(O),{key:1,"ds-data":_.list},{default:h(()=>[e("div",W,[e("div",X,[e("div",Z,[e("table",ee,[e("thead",null,[e("tr",null,[se,(c(!0),u(B,null,I(L,i=>(c(),u("th",{class:"text-capitalize",key:i.field},l(i.name),1))),128)),e("th",ae,l(s.$t("Actions")),1)])]),o(t(D),{tag:"tbody",class:"fs-sm"},{default:h(({row:i,rowIndex:$})=>{var x;return[e("tr",oe,[e("th",te,l($+1),1),e("td",null,l(i.name),1),e("td",null,l((x=i.region)==null?void 0:x.name_uz),1),e("td",le,[e("a",{href:"javascript:;",class:"text-danger","data-bs-toggle":"modal","data-bs-target":"#modal-confirm",onClick:xe=>w(i.id)},re,8,ne)])])]}),_:1})])])])])]),_:1},8,["ds-data"]))]}),_:1}),e("div",ce,[e("div",de,[e("div",me,[e("div",ue,[e("h5",_e,l(p.value?"Akselerogramma ma'lumotlarini o'zgartirish":"Yangi akselerogramma ma'lumotlarini qo'shish"),1),fe]),e("div",he,[e("form",{onSubmit:Y(A,["prevent"])},[e("div",pe,[e("div",be,[o(M,{value:"Viloyatlar ro'yhati"}),o(t(K),{modelValue:t(a).region_soato,"onUpdate:modelValue":r[0]||(r[0]=n=>t(a).region_soato=n),options:_.regions,label:"name_uz",reduce:n=>Number(n.soato),placeholder:"Viloyatni tanlang"},null,8,["modelValue","options","reduce"]),o(k,{message:(v=t(a).errors)==null?void 0:v.region_soato},null,8,["message"])]),e("div",ve,[o(M,{value:"Faylni tanlang",for:"uploaded-file"}),o(U,{id:"uploaded-file",type:"file",onChange:V,accept:".xlsx,.xls"}),o(k,{message:(y=t(a).errors)==null?void 0:y.excel_file},null,8,["message"])]),e("div",ye,[o(J,{loading:t(a).processing},null,8,["loading"])])])],40,ge)])])])]),o(H,{onConfirm:S})])}}});export{qe as default};
